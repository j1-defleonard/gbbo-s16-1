<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2299.77">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4689cc; -webkit-text-stroke: #4689cc}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #8cd3fe; -webkit-text-stroke: #8cd3fe}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #c27e65; -webkit-text-stroke: #c27e65}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d7378; -webkit-text-stroke: #6d7378}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #71c083; -webkit-text-stroke: #71c083}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #a7c598; -webkit-text-stroke: #a7c598}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca; min-height: 16.0px}
    span.s1 {font-kerning: none; background-color: #171818}
    span.s2 {font-kerning: none; color: #8cd3fe; background-color: #171818; -webkit-text-stroke: 0px #8cd3fe}
    span.s3 {font-kerning: none; color: #6d6d6d; background-color: #171818; -webkit-text-stroke: 0px #6d6d6d}
    span.s4 {font-kerning: none; color: #cacaca; background-color: #171818; -webkit-text-stroke: 0px #cacaca}
    span.s5 {font-kerning: none; color: #c27e65; background-color: #171818; -webkit-text-stroke: 0px #c27e65}
    span.s6 {font-kerning: none; color: #4689cc; background-color: #171818; -webkit-text-stroke: 0px #4689cc}
    span.s7 {font-kerning: none; color: #d4d4d4; background-color: #171818; -webkit-text-stroke: 0px #d4d4d4}
    span.s8 {font-kerning: none; color: #71c083; background-color: #171818; -webkit-text-stroke: 0px #71c083}
    span.s9 {font-kerning: none; color: #a7c598; background-color: #171818; -webkit-text-stroke: 0px #a7c598}
    span.s10 {font-kerning: none; color: #6d7378; background-color: #171818; -webkit-text-stroke: 0px #6d7378}
    span.s11 {font-kerning: none}
    span.s12 {font-kerning: none; color: #b76ff7; background-color: #171818; -webkit-text-stroke: 0px #b76ff7}
    span.s13 {font-kerning: none; color: #36c0a0; background-color: #171818; -webkit-text-stroke: 0px #36c0a0}
    span.s14 {font-kerning: none; color: #f67c30; background-color: #171818; -webkit-text-stroke: 0px #f67c30}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"en"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">GBBO Fantasy League - Series 16</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"preconnect"</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"preconnect"</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.gstatic.com"</span><span class="s4"> </span><span class="s2">crossorigin</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&amp;display=swap"</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"stylesheet"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">body</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-family:</span><span class="s1"> </span><span class="s8">'Roboto'</span><span class="s7">,</span><span class="s1"> </span><span class="s5">sans-serif</span><span class="s7">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s4"> #fdfdfb</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Creamy off-white */</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-image:</span><span class="s4"> </span><span class="s5">url</span><span class="s7">(</span><span class="s1">"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23eef3f3' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.font-brand</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-family:</span><span class="s1"> </span><span class="s8">'Roboto'</span><span class="s7">,</span><span class="s1"> </span><span class="s5">sans-serif</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s1"> </span><span class="s9">900</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.modal-backdrop</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">background-color:</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s9">0</span><span class="s7">,</span><span class="s9">0</span><span class="s7">,</span><span class="s9">0</span><span class="s7">,</span><span class="s9">0.5</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">-webkit-backdrop-filter:</span><span class="s4"> </span><span class="s5">blur(</span><span class="s9">4px</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">backdrop-filter:</span><span class="s4"> </span><span class="s5">blur(</span><span class="s9">4px</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.gbbo-card</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">background-color:</span><span class="s4"> </span><span class="s5">white</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">16px</span><span class="s7">;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s4"> </span><span class="s1">0</span><span class="s4"> </span><span class="s1">10px</span><span class="s4"> </span><span class="s1">25px</span><span class="s4"> </span><span class="s1">-5px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s1">0</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0.07</span><span class="s5">)</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0</span><span class="s4"> </span><span class="s1">4px</span><span class="s4"> </span><span class="s1">6px</span><span class="s4"> </span><span class="s1">-2px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s1">0</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0.05</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border:</span><span class="s1"> </span><span class="s9">1px</span><span class="s1"> </span><span class="s5">solid</span><span class="s1"> #eef3f3</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.gbbo-button</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #e45c85</span><span class="s7">;</span><span class="s1"> </span><span class="s10">/* Raspberry Pink */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> </span><span class="s5">white</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">9999px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s1"> </span><span class="s9">12px</span><span class="s1"> </span><span class="s9">28px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s1"> </span><span class="s9">600</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s1"> </span><span class="s5">all</span><span class="s1"> </span><span class="s9">0.2s</span><span class="s1"> </span><span class="s5">cubic-bezier(</span><span class="s9">0.4</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0.2</span><span class="s7">,</span><span class="s1"> </span><span class="s9">1</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s4"> </span><span class="s1">0</span><span class="s4"> </span><span class="s1">4px</span><span class="s4"> </span><span class="s1">6px</span><span class="s4"> </span><span class="s1">-1px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s1">228</span><span class="s7">,</span><span class="s4"> </span><span class="s1">92</span><span class="s7">,</span><span class="s4"> </span><span class="s1">133</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0.3</span><span class="s5">)</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0</span><span class="s4"> </span><span class="s1">2px</span><span class="s4"> </span><span class="s1">4px</span><span class="s4"> </span><span class="s1">-1px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s1">228</span><span class="s7">,</span><span class="s4"> </span><span class="s1">92</span><span class="s7">,</span><span class="s4"> </span><span class="s1">133</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0.2</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.gbbo-button:hover</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #d14a74</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translateY(</span><span class="s9">-2px</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s4"> </span><span class="s1">0</span><span class="s4"> </span><span class="s1">10px</span><span class="s4"> </span><span class="s1">15px</span><span class="s4"> </span><span class="s1">-3px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s1">228</span><span class="s7">,</span><span class="s4"> </span><span class="s1">92</span><span class="s7">,</span><span class="s4"> </span><span class="s1">133</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0.3</span><span class="s5">)</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0</span><span class="s4"> </span><span class="s1">4px</span><span class="s4"> </span><span class="s1">6px</span><span class="s4"> </span><span class="s1">-2px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s1">228</span><span class="s7">,</span><span class="s4"> </span><span class="s1">92</span><span class="s7">,</span><span class="s4"> </span><span class="s1">133</span><span class="s7">,</span><span class="s4"> </span><span class="s1">0.2</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">         </span></span><span class="s1">.gbbo-button-secondary</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #d4e6e5</span><span class="s7">;</span><span class="s1"> </span><span class="s10">/* Light Teal */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> #32aad7</span><span class="s7">;</span><span class="s1"> </span><span class="s10">/* New Blue */</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">9999px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s1"> </span><span class="s9">10px</span><span class="s1"> </span><span class="s9">24px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s1"> </span><span class="s9">600</span><span class="s7">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s4"> </span><span class="s1">background-color</span><span class="s4"> </span><span class="s9">0.2s</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.gbbo-button-secondary:hover</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s2">background-color:</span><span class="s1"> #c3d9d8</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.gbbo-button-action</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">background-color:</span><span class="s4"> </span><span class="s5">transparent</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> #475569</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border:</span><span class="s1"> </span><span class="s9">1px</span><span class="s1"> </span><span class="s5">solid</span><span class="s1"> #e2e8f0</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">9999px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s1"> </span><span class="s9">6px</span><span class="s1"> </span><span class="s9">14px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s1"> </span><span class="s9">500</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-size:</span><span class="s1"> </span><span class="s9">0.875rem</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s1"> </span><span class="s5">all</span><span class="s1"> </span><span class="s9">0.2s</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">display:</span><span class="s1"> </span><span class="s5">inline-flex</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">align-items:</span><span class="s1"> </span><span class="s5">center</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">gap:</span><span class="s1"> </span><span class="s9">0.5rem</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.gbbo-button-action:hover</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #f8fafc</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border-color:</span><span class="s1"> #cbd5e1</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> #32aad7</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-slate-700"</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"app"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"max-w-7xl mx-auto p-4 md:p-8"</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"firebase-error-banner"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative mb-6"</span><span class="s4"> </span><span class="s2">role</span><span class="s3">=</span><span class="s1">"alert"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">strong</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"font-bold"</span><span class="s3">&gt;</span><span class="s1">Configuration Error!</span><span class="s3">&lt;/</span><span class="s6">strong</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"firebase-error-message"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"block sm:inline"</span><span class="s3">&gt;</span><span class="s1">Could not connect to Firebase. Live Mode has been disabled.</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">header</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-center mb-10"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h1</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-brand text-6xl md:text-7xl text-[#32aad7] tracking-tight"</span><span class="s3">&gt;</span><span class="s4">GBBO Fantasy League</span><span class="s3">&lt;/</span><span class="s6">h1</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xl text-slate-500 mt-2"</span><span class="s3">&gt;</span><span class="s4">Series 16</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">header</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-center mb-10"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white p-1.5 rounded-full shadow-sm border border-slate-200"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"preview-mode-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"px-5 py-2 rounded-full text-sm font-semibold transition-colors"</span><span class="s3">&gt;</span><span class="s4">Preview Mode</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"live-mode-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"px-5 py-2 rounded-full text-sm font-semibold transition-colors"</span><span class="s3">&gt;</span><span class="s4">Live Mode</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"user-selection"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"gbbo-card max-w-md mx-auto p-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">             </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"live-league-selection"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold mb-6 text-center text-slate-800"</span><span class="s3">&gt;</span><span class="s4">Live Mode</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-col space-y-4"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"show-create-league-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full gbbo-button"</span><span class="s3">&gt;</span><span class="s4">Create a New League</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"show-join-league-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full gbbo-button-secondary"</span><span class="s3">&gt;</span><span class="s4">Join an Existing League</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"create-league-form"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold mb-6 text-center text-slate-800"</span><span class="s3">&gt;</span><span class="s4">Create a League</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"creator-name"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-sm font-medium text-slate-600 mb-2"</span><span class="s3">&gt;</span><span class="s4">Your Name:</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"creator-name"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block w-full px-4 py-3 border border-slate-300 rounded-full shadow-sm"</span><span class="s4"> </span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"e.g., Prue Leith"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"create-league-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-6 w-full gbbo-button"</span><span class="s3">&gt;</span><span class="s4">Create League</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"back-to-selection-btn mt-2 w-full text-sm text-slate-500 hover:text-slate-800"</span><span class="s3">&gt;</span><span class="s4">Back</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">             </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"join-league-form"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold mb-6 text-center text-slate-800"</span><span class="s3">&gt;</span><span class="s4">Join a League</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"space-y-4"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"joiner-name"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-sm font-medium text-slate-600 mb-2"</span><span class="s3">&gt;</span><span class="s4">Your Name:</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"joiner-name"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block w-full px-4 py-3 border border-slate-300 rounded-full shadow-sm"</span><span class="s4"> </span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"e.g., Paul Hollywood"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"league-id-input"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-sm font-medium text-slate-600 mb-2"</span><span class="s3">&gt;</span><span class="s4">League ID:</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"league-id-input"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block w-full px-4 py-3 border border-slate-300 rounded-full shadow-sm"</span><span class="s4"> </span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"Enter 6-character code"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"join-league-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-6 w-full gbbo-button"</span><span class="s3">&gt;</span><span class="s4">Join League</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"back-to-selection-btn mt-2 w-full text-sm text-slate-500 hover:text-slate-800"</span><span class="s3">&gt;</span><span class="s4">Back</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"preview-user-selection"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold mb-6 text-center text-slate-800"</span><span class="s3">&gt;</span><span class="s4">Preview Mode</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"user-dropdown"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-sm font-medium text-slate-600 mb-2"</span><span class="s3">&gt;</span><span class="s4">Select a user to preview:</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">select</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"user-dropdown"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block w-full pl-4 pr-10 py-3 text-base border-slate-300 focus:outline-none focus:ring-[#e45c85] focus:border-[#e45c85] sm:text-sm rounded-full"</span><span class="s3">&gt;&lt;/</span><span class="s6">select</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">main</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"main-content"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"draft-section"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"p-8 mb-8 hidden"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold mb-6 text-center text-slate-800"</span><span class="s3">&gt;</span><span class="s4">Baker Draft</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"draft-info"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-center mb-6"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"draft-turn-info"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-xl"</span><span class="s3">&gt;</span><span class="s1">Round: </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"round-number"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"font-bold"</span><span class="s3">&gt;</span><span class="s1">1</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xl"</span><span class="s3">&gt;</span><span class="s4">It's </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"current-player"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold text-[#e45c85]"</span><span class="s3">&gt;&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4">'s turn to pick!</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"draft-message"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"draft-order"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-center flex-wrap gap-3 mb-8"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"available-bakers-draft"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"live-admin-controls"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mb-8 text-center"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-1 lg:grid-cols-3 gap-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"lg:col-span-2 space-y-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">section</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"team-section"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"gbbo-card p-6 md:p-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold mb-1 text-slate-800"</span><span class="s3">&gt;</span><span class="s4">Your Team</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-slate-500 mb-6"</span><span class="s3">&gt;</span><span class="s1">Click on a baker to see their weekly points breakdown.</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"your-team"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">section</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                     </span></span><span class="s3">&lt;</span><span class="s6">section</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"trades-section"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"gbbo-card p-6 md:p-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold mb-6 text-slate-800"</span><span class="s3">&gt;</span><span class="s4">Trades</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"trades-container"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">section</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-1 md:grid-cols-2 gap-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">section</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"free-agents-section"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"gbbo-card p-6 md:p-8"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-3xl font-bold mb-6 text-slate-800"</span><span class="s3">&gt;</span><span class="s1">Available Bakers</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"available-bakers-fa"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-wrap gap-4"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">section</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">section</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"eliminated-bakers-section"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"gbbo-card p-6 md:p-8"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-3xl font-bold mb-6 text-slate-800"</span><span class="s3">&gt;</span><span class="s1">Eliminated Bakers</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"eliminated-bakers"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-wrap gap-4"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">section</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"lg:col-span-1 space-y-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">section</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"scoreboard-section"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"gbbo-card p-6 md:p-8"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-3xl font-bold mb-1 text-slate-800"</span><span class="s3">&gt;</span><span class="s1">League Scoreboard</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-slate-500 mb-6"</span><span class="s3">&gt;</span><span class="s1">Click on a player to see their team's breakdown.</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"scoreboard"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"space-y-4"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">section</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"admin-panel"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"gbbo-card p-6 md:p-8 hidden"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold mb-6 text-slate-800"</span><span class="s3">&gt;</span><span class="s4">Admin Panel</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"admin-actions"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">main</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Modals --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"weekly-log-modal"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"fixed inset-0 z-50 hidden items-center justify-center p-4 modal-backdrop"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"trade-proposal-modal"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"fixed inset-0 z-50 hidden items-center justify-center p-4 modal-backdrop"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"module"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s12">import</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> initializeApp </span><span class="s7">}</span><span class="s4"> </span><span class="s12">from</span><span class="s4"> </span><span class="s1">"https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">import</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> getFirestore</span><span class="s7">,</span><span class="s1"> setLogLevel</span><span class="s7">,</span><span class="s1"> doc</span><span class="s7">,</span><span class="s1"> getDoc</span><span class="s7">,</span><span class="s1"> getDocs</span><span class="s7">,</span><span class="s1"> setDoc</span><span class="s7">,</span><span class="s1"> onSnapshot</span><span class="s7">,</span><span class="s1"> collection</span><span class="s7">,</span><span class="s1"> query</span><span class="s7">,</span><span class="s1"> writeBatch</span><span class="s7">,</span><span class="s1"> where</span><span class="s7">,</span><span class="s1"> addDoc</span><span class="s7">,</span><span class="s1"> deleteDoc</span><span class="s7">,</span><span class="s1"> runTransaction </span><span class="s7">}</span><span class="s1"> </span><span class="s12">from</span><span class="s1"> </span><span class="s8">"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">import</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> getAuth</span><span class="s7">,</span><span class="s1"> signInAnonymously</span><span class="s7">,</span><span class="s1"> signInWithCustomToken </span><span class="s7">}</span><span class="s1"> </span><span class="s12">from</span><span class="s1"> </span><span class="s8">"https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- CONFIGURATION ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> firebaseConfig </span><span class="s7">=</span><span class="s1"> </span><span class="s12">typeof</span><span class="s1"> __firebase_config </span><span class="s7">!==</span><span class="s1"> </span><span class="s8">'undefined'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s13">JSON</span><span class="s7">.</span><span class="s1">parse</span><span class="s7">(</span><span class="s1">__firebase_config</span><span class="s7">)</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s7">{};</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s4"> appId </span><span class="s7">=</span><span class="s4"> </span><span class="s12">typeof</span><span class="s4"> __app_id </span><span class="s7">!==</span><span class="s4"> </span><span class="s1">'undefined'</span><span class="s4"> </span><span class="s7">?</span><span class="s4"> __app_id </span><span class="s7">:</span><span class="s4"> </span><span class="s1">'gbbo-fantasy-league-default'</span><span class="s7">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s4"> bakersSeries16 </span><span class="s7">=</span><span class="s4"> </span><span class="s7">[</span><span class="s4"> </span><span class="s1">"Aaron Mountford-Myles"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Iain Ross"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Jasmine Mitchell"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Jessika Trassel"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Leighton Morgan"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Lesley Holloway"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Nadia Mercuri"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Nataliia Richardson"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Pui Man Li"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Toby Littlewood"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Tom Arden"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Hassan Islam"</span><span class="s4"> </span><span class="s7">];</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s4"> previewUsers </span><span class="s7">=</span><span class="s4"> </span><span class="s7">[</span><span class="s4"> </span><span class="s1">"Mary Berry's Ghost"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Soggy Bottom Boys"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"The Fondant Fancies"</span><span class="s4"> </span><span class="s7">];</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- APP STATE ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> db</span><span class="s7">,</span><span class="s1"> auth</span><span class="s7">,</span><span class="s1"> mode </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s7">,</span><span class="s1"> currentUser </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">,</span><span class="s1"> userId </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">,</span><span class="s1"> unsubscribe </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{},</span><span class="s1"> currentLeagueState </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{},</span><span class="s1"> currentLeagueId </span><span class="s7">=</span><span class="s1"> </span><span class="s12">null</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- DOM ELEMENTS ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> getEl </span><span class="s7">=</span><span class="s1"> </span><span class="s7">(</span><span class="s1">id</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s1">id</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> userSelectionDiv </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'user-selection'</span><span class="s7">),</span><span class="s1"> mainContentDiv </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'main-content'</span><span class="s7">),</span><span class="s1"> previewModeBtn </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'preview-mode-btn'</span><span class="s7">),</span><span class="s1"> liveModeBtn </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'live-mode-btn'</span><span class="s7">),</span><span class="s1"> previewUserInput </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'preview-user-selection'</span><span class="s7">),</span><span class="s1"> userDropdown </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'user-dropdown'</span><span class="s7">),</span><span class="s1"> errorBanner </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'firebase-error-banner'</span><span class="s7">),</span><span class="s1"> errorMessageSpan </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'firebase-error-message'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> liveLeagueSelection </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'live-league-selection'</span><span class="s7">),</span><span class="s1"> createLeagueForm </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'create-league-form'</span><span class="s7">),</span><span class="s1"> joinLeagueForm </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'join-league-form'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> draftSection </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'draft-section'</span><span class="s7">),</span><span class="s1"> adminPanel </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'admin-panel'</span><span class="s7">),</span><span class="s1"> adminActions </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'admin-actions'</span><span class="s7">),</span><span class="s1"> liveAdminControls </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'live-admin-controls'</span><span class="s7">),</span><span class="s1"> weeklyLogModal </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'weekly-log-modal'</span><span class="s7">),</span><span class="s1"> tradeProposalModal </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'trade-proposal-modal'</span><span class="s7">);</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- INITIALIZATION ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> init</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">try</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s13">Object</span><span class="s7">.</span><span class="s1">keys</span><span class="s7">(</span><span class="s1">firebaseConfig</span><span class="s7">).</span><span class="s1">length </span><span class="s7">===</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s12">throw</span><span class="s1"> </span><span class="s12">new</span><span class="s1"> </span><span class="s13">Error</span><span class="s7">(</span><span class="s8">"Firebase configuration is not available."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> app </span><span class="s7">=</span><span class="s1"> initializeApp</span><span class="s7">(</span><span class="s1">firebaseConfig</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>db </span><span class="s7">=</span><span class="s1"> getFirestore</span><span class="s7">(</span><span class="s1">app</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>auth </span><span class="s7">=</span><span class="s1"> getAuth</span><span class="s7">(</span><span class="s1">app</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s12">typeof</span><span class="s1"> __initial_auth_token </span><span class="s7">!==</span><span class="s1"> </span><span class="s8">'undefined'</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> __initial_auth_token</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">await</span><span class="s1"> signInWithCustomToken</span><span class="s7">(</span><span class="s1">auth</span><span class="s7">,</span><span class="s1"> __initial_auth_token</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">await</span><span class="s1"> signInAnonymously</span><span class="s7">(</span><span class="s1">auth</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>userId </span><span class="s7">=</span><span class="s1"> auth</span><span class="s7">.</span><span class="s1">currentUser</span><span class="s7">?.</span><span class="s1">uid </span><span class="s7">||</span><span class="s1"> crypto</span><span class="s7">.</span><span class="s1">randomUUID</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>setLogLevel</span><span class="s7">(</span><span class="s8">'debug'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">catch</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">error</span><span class="s7">(</span><span class="s1">"Firebase initialization failed."</span><span class="s7">,</span><span class="s4"> e</span><span class="s7">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>errorMessageSpan</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> e</span><span class="s7">.</span><span class="s4">code </span><span class="s7">===</span><span class="s4"> </span><span class="s1">'auth/configuration-not-found'</span><span class="s4"> </span><span class="s7">?</span><span class="s4"> </span><span class="s1">"The 'Anonymous' sign-in method is not enabled in your Firebase project. Please enable it in the Firebase Console. Live Mode is disabled."</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">`Could not connect to Firebase. Live Mode has been disabled. Error: </span><span class="s7">${</span><span class="s4">e</span><span class="s7">.</span><span class="s4">message</span><span class="s7">}</span><span class="s1">`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>errorBanner</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'block'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>liveModeBtn</span><span class="s7">.</span><span class="s1">disabled </span><span class="s7">=</span><span class="s1"> </span><span class="s12">true</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>liveModeBtn</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'cursor-not-allowed'</span><span class="s7">,</span><span class="s1"> </span><span class="s8">'opacity-50'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>db </span><span class="s7">=</span><span class="s1"> </span><span class="s12">null</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setupEventListeners</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>updateUIMode</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- UI &amp; MODE MANAGEMENT ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> setupEventListeners</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>previewModeBtn</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> switchMode</span><span class="s7">(</span><span class="s8">'preview'</span><span class="s7">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>liveModeBtn</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">liveModeBtn</span><span class="s7">.</span><span class="s1">disabled</span><span class="s7">)</span><span class="s1"> switchMode</span><span class="s7">(</span><span class="s8">'live'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>userDropdown</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'change'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s12">if</span><span class="s7">(</span><span class="s1">e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">value</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> currentUser </span><span class="s7">=</span><span class="s1"> e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">value</span><span class="s7">;</span><span class="s1"> loginAndSetup</span><span class="s7">();</span><span class="s1"> </span><span class="s7">}</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getEl</span><span class="s7">(</span><span class="s8">'show-create-league-btn'</span><span class="s7">).</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> showLeagueForm</span><span class="s7">(</span><span class="s8">'create'</span><span class="s7">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getEl</span><span class="s7">(</span><span class="s8">'show-join-league-btn'</span><span class="s7">).</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> showLeagueForm</span><span class="s7">(</span><span class="s8">'join'</span><span class="s7">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s1">querySelectorAll</span><span class="s7">(</span><span class="s8">'.back-to-selection-btn'</span><span class="s7">).</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">btn </span><span class="s7">=&gt;</span><span class="s1"> btn</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> showLeagueForm</span><span class="s7">(</span><span class="s8">'selection'</span><span class="s7">)));</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getEl</span><span class="s7">(</span><span class="s8">'create-league-btn'</span><span class="s7">).</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> handleCreateLeague</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getEl</span><span class="s7">(</span><span class="s8">'join-league-btn'</span><span class="s7">).</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> handleJoinLeague</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> switchMode</span><span class="s7">(</span><span class="s1">newMode</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>mode </span><span class="s7">=</span><span class="s1"> newMode</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">Object</span><span class="s7">.</span><span class="s1">values</span><span class="s7">(</span><span class="s1">unsubscribe</span><span class="s7">).</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">unsub </span><span class="s7">=&gt;</span><span class="s1"> unsub</span><span class="s7">());</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>unsubscribe </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentUser </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentLeagueId </span><span class="s7">=</span><span class="s1"> </span><span class="s12">null</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>userSelectionDiv</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'block'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>mainContentDiv</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>draftSection</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>adminPanel</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>liveAdminControls</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>updateUIMode</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> updateUIMode</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> isPreview </span><span class="s7">=</span><span class="s1"> mode </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>previewModeBtn</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">toggle</span><span class="s7">(</span><span class="s8">'bg-[#32aad7]'</span><span class="s7">,</span><span class="s1"> isPreview</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>previewModeBtn</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">toggle</span><span class="s7">(</span><span class="s8">'text-white'</span><span class="s7">,</span><span class="s1"> isPreview</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>liveModeBtn</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">toggle</span><span class="s7">(</span><span class="s8">'bg-[#32aad7]'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">!</span><span class="s1">isPreview</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>liveModeBtn</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">toggle</span><span class="s7">(</span><span class="s8">'text-white'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">!</span><span class="s1">isPreview</span><span class="s7">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>previewUserInput</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> isPreview </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'block'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>liveLeagueSelection</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> isPreview </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'none'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s8">'block'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>createLeagueForm</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>joinLeagueForm</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">db</span><span class="s7">)</span><span class="s1"> adminPanel</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> isPreview </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'block'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">isPreview</span><span class="s7">)</span><span class="s1"> populateUserDropdown</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> showLeagueForm</span><span class="s7">(</span><span class="s1">formType</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>liveLeagueSelection</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> formType </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'selection'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'block'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>createLeagueForm</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> formType </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'create'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'block'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>joinLeagueForm</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> formType </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'join'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'block'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> populateUserDropdown</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span>userDropdown</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> </span><span class="s1">`&lt;option value="" disabled selected&gt;Select a user&lt;/option&gt;`</span><span class="s4"> </span><span class="s7">+</span><span class="s4"> previewUsers</span><span class="s7">.</span><span class="s4">map</span><span class="s7">(</span><span class="s4">user </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`&lt;option value="</span><span class="s7">${</span><span class="s4">user</span><span class="s7">}</span><span class="s1">"&gt;</span><span class="s7">${</span><span class="s4">user</span><span class="s7">}</span><span class="s1">&lt;/option&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s7">(</span><span class="s1">currentUser</span><span class="s7">)</span><span class="s1"> userDropdown</span><span class="s7">.</span><span class="s1">value </span><span class="s7">=</span><span class="s1"> currentUser</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> loginAndSetup</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>userSelectionDiv</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>mainContentDiv</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'block'</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">db</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">await</span><span class="s1"> setupFirestoreData</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>listenToLeagueData</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">mode </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> leagueRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/leagues/preview`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> leagueSnap </span><span class="s7">=</span><span class="s1"> </span><span class="s12">await</span><span class="s1"> getDoc</span><span class="s7">(</span><span class="s1">leagueRef</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">leagueSnap</span><span class="s7">.</span><span class="s1">exists</span><span class="s7">()</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> leagueSnap</span><span class="s7">.</span><span class="s1">data</span><span class="s7">().</span><span class="s1">status </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'not-started'</span><span class="s7">)</span><span class="s1"> </span><span class="s12">await</span><span class="s1"> simulateDraft</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>renderForPreviewWithoutDb</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> handleCreateLeague</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> creatorName </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'creator-name'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">.</span><span class="s1">trim</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s7">(!</span><span class="s1">creatorName</span><span class="s7">)</span><span class="s1"> </span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentUser </span><span class="s7">=</span><span class="s1"> creatorName</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentLeagueId </span><span class="s7">=</span><span class="s1"> </span><span class="s13">Math</span><span class="s7">.</span><span class="s1">random</span><span class="s7">().</span><span class="s1">toString</span><span class="s7">(</span><span class="s14">36</span><span class="s7">).</span><span class="s1">substring</span><span class="s7">(</span><span class="s14">2</span><span class="s7">,</span><span class="s1"> </span><span class="s14">8</span><span class="s7">).</span><span class="s1">toUpperCase</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">await</span><span class="s1"> loginAndSetup</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> handleJoinLeague</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> joinerName </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'joiner-name'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">.</span><span class="s1">trim</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueId </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'league-id-input'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">.</span><span class="s1">trim</span><span class="s7">().</span><span class="s1">toUpperCase</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s7">(!</span><span class="s1">joinerName </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">leagueId</span><span class="s7">)</span><span class="s1"> </span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/leagues/</span><span class="s7">${</span><span class="s1">leagueId</span><span class="s7">}</span><span class="s8">`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueSnap </span><span class="s7">=</span><span class="s1"> </span><span class="s12">await</span><span class="s1"> getDoc</span><span class="s7">(</span><span class="s1">leagueRef</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">leagueSnap</span><span class="s7">.</span><span class="s1">exists</span><span class="s7">())</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>alert</span><span class="s7">(</span><span class="s1">"League not found. Please check the ID and try again."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentUser </span><span class="s7">=</span><span class="s1"> joinerName</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentLeagueId </span><span class="s7">=</span><span class="s1"> leagueId</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">await</span><span class="s1"> loginAndSetup</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- FIRESTORE SETUP &amp; LISTENERS ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> setupFirestoreData</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueId </span><span class="s7">=</span><span class="s1"> mode </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> currentLeagueId</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/leagues/</span><span class="s7">${</span><span class="s1">leagueId</span><span class="s7">}</span><span class="s8">`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueSnap </span><span class="s7">=</span><span class="s1"> </span><span class="s12">await</span><span class="s1"> getDoc</span><span class="s7">(</span><span class="s1">leagueRef</span><span class="s7">);</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">leagueSnap</span><span class="s7">.</span><span class="s1">exists</span><span class="s7">())</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s10">// Creating a new league</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> batch </span><span class="s7">=</span><span class="s1"> writeBatch</span><span class="s7">(</span><span class="s1">db</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> usersToSetup </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[</span><span class="s1">currentUser</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> shuffledUsers </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[</span><span class="s1">currentUser</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>batch</span><span class="s7">.</span><span class="s12">set</span><span class="s7">(</span><span class="s1">leagueRef</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> status</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'not-started'</span><span class="s7">,</span><span class="s1"> currentPlayer</span><span class="s7">:</span><span class="s1"> shuffledUsers</span><span class="s7">[</span><span class="s14">0</span><span class="s7">],</span><span class="s1"> draftOrder</span><span class="s7">:</span><span class="s1"> shuffledUsers</span><span class="s7">,</span><span class="s1"> round</span><span class="s7">:</span><span class="s1"> </span><span class="s14">1</span><span class="s7">,</span><span class="s1"> availableBakers</span><span class="s7">:</span><span class="s1"> bakersSeries16</span><span class="s7">,</span><span class="s1"> week</span><span class="s7">:</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>bakersSeries16</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">bakerName </span><span class="s7">=&gt;</span><span class="s1"> batch</span><span class="s7">.</span><span class="s12">set</span><span class="s7">(</span><span class="s1">doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/leagues/</span><span class="s7">${</span><span class="s1">leagueId</span><span class="s7">}</span><span class="s8">/bakers/</span><span class="s7">${</span><span class="s1">bakerName</span><span class="s7">}</span><span class="s8">`</span><span class="s7">),</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> name</span><span class="s7">:</span><span class="s1"> bakerName</span><span class="s7">,</span><span class="s1"> status</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'active'</span><span class="s7">,</span><span class="s1"> points</span><span class="s7">:</span><span class="s1"> </span><span class="s14">0</span><span class="s7">,</span><span class="s1"> weeklyLog</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[]</span><span class="s1"> </span><span class="s7">}));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>usersToSetup</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">userName </span><span class="s7">=&gt;</span><span class="s1"> batch</span><span class="s7">.</span><span class="s12">set</span><span class="s7">(</span><span class="s1">doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/leagues/</span><span class="s7">${</span><span class="s1">leagueId</span><span class="s7">}</span><span class="s8">/users/</span><span class="s7">${</span><span class="s1">userName</span><span class="s7">}</span><span class="s8">`</span><span class="s7">),</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> name</span><span class="s7">:</span><span class="s1"> userName</span><span class="s7">,</span><span class="s1"> team</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[]</span><span class="s1"> </span><span class="s7">}));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">await</span><span class="s1"> batch</span><span class="s7">.</span><span class="s1">commit</span><span class="s7">();</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s4"> </span><span class="s12">else</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> </span><span class="s1">// Joining an existing league</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> userRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/leagues/</span><span class="s7">${</span><span class="s1">leagueId</span><span class="s7">}</span><span class="s8">/users/</span><span class="s7">${</span><span class="s1">currentUser</span><span class="s7">}</span><span class="s8">`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!(</span><span class="s12">await</span><span class="s1"> getDoc</span><span class="s7">(</span><span class="s1">userRef</span><span class="s7">)).</span><span class="s1">exists</span><span class="s7">())</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">await</span><span class="s1"> setDoc</span><span class="s7">(</span><span class="s1">userRef</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> name</span><span class="s7">:</span><span class="s1"> currentUser</span><span class="s7">,</span><span class="s1"> team</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[]</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> leagueData </span><span class="s7">=</span><span class="s1"> leagueSnap</span><span class="s7">.</span><span class="s1">data</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s7">(</span><span class="s1">leagueData</span><span class="s7">.</span><span class="s1">status </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'not-started'</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> </span><span class="s7">!</span><span class="s1">leagueData</span><span class="s7">.</span><span class="s1">draftOrder</span><span class="s7">.</span><span class="s1">includes</span><span class="s7">(</span><span class="s1">currentUser</span><span class="s7">))</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">await</span><span class="s1"> setDoc</span><span class="s7">(</span><span class="s1">leagueRef</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> draftOrder</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[...</span><span class="s1">leagueData</span><span class="s7">.</span><span class="s1">draftOrder</span><span class="s7">,</span><span class="s1"> currentUser</span><span class="s7">]</span><span class="s1"> </span><span class="s7">},</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> merge</span><span class="s7">:</span><span class="s1"> </span><span class="s12">true</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> listenToLeagueData</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">db</span><span class="s7">)</span><span class="s1"> </span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueId </span><span class="s7">=</span><span class="s1"> mode </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> currentLeagueId</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s7">(!</span><span class="s1">leagueId</span><span class="s7">)</span><span class="s1"> </span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leaguePath </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/leagues/</span><span class="s7">${</span><span class="s1">leagueId</span><span class="s7">}</span><span class="s8">`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>unsubscribe</span><span class="s7">.</span><span class="s1">league </span><span class="s7">=</span><span class="s1"> onSnapshot</span><span class="s7">(</span><span class="s1">doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> leaguePath</span><span class="s7">),</span><span class="s1"> docSnap </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s12">if</span><span class="s7">(</span><span class="s1">docSnap</span><span class="s7">.</span><span class="s1">exists</span><span class="s7">())</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> currentLeagueState </span><span class="s7">=</span><span class="s1"> docSnap</span><span class="s7">.</span><span class="s1">data</span><span class="s7">();</span><span class="s1"> renderAll</span><span class="s7">();</span><span class="s1"> </span><span class="s7">}</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>unsubscribe</span><span class="s7">.</span><span class="s1">bakers </span><span class="s7">=</span><span class="s1"> onSnapshot</span><span class="s7">(</span><span class="s1">collection</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`</span><span class="s7">${</span><span class="s1">leaguePath</span><span class="s7">}</span><span class="s8">/bakers`</span><span class="s7">),</span><span class="s1"> snapshot </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> lastKnownBakers </span><span class="s7">=</span><span class="s1"> snapshot</span><span class="s7">.</span><span class="s1">docs</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">d </span><span class="s7">=&gt;</span><span class="s1"> d</span><span class="s7">.</span><span class="s1">data</span><span class="s7">());</span><span class="s1"> renderAll</span><span class="s7">();</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>unsubscribe</span><span class="s7">.</span><span class="s1">users </span><span class="s7">=</span><span class="s1"> onSnapshot</span><span class="s7">(</span><span class="s1">collection</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`</span><span class="s7">${</span><span class="s1">leaguePath</span><span class="s7">}</span><span class="s8">/users`</span><span class="s7">),</span><span class="s1"> snapshot </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> lastKnownUsers </span><span class="s7">=</span><span class="s1"> snapshot</span><span class="s7">.</span><span class="s1">docs</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">d </span><span class="s7">=&gt;</span><span class="s1"> d</span><span class="s7">.</span><span class="s1">data</span><span class="s7">());</span><span class="s1"> renderAll</span><span class="s7">();</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>unsubscribe</span><span class="s7">.</span><span class="s1">trades </span><span class="s7">=</span><span class="s1"> onSnapshot</span><span class="s7">(</span><span class="s1">query</span><span class="s7">(</span><span class="s1">collection</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`</span><span class="s7">${</span><span class="s1">leaguePath</span><span class="s7">}</span><span class="s8">/trades`</span><span class="s7">),</span><span class="s1"> where</span><span class="s7">(</span><span class="s8">"status"</span><span class="s7">,</span><span class="s1"> </span><span class="s8">"=="</span><span class="s7">,</span><span class="s1"> </span><span class="s8">"pending"</span><span class="s7">)),</span><span class="s1"> snapshot </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> lastKnownTrades </span><span class="s7">=</span><span class="s1"> snapshot</span><span class="s7">.</span><span class="s1">docs</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">d </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">({</span><span class="s1">id</span><span class="s7">:</span><span class="s1"> d</span><span class="s7">.</span><span class="s1">id</span><span class="s7">,</span><span class="s1"> </span><span class="s7">...</span><span class="s1">d</span><span class="s7">.</span><span class="s1">data</span><span class="s7">()}));</span><span class="s1"> renderAll</span><span class="s7">();</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- RENDERING ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> lastKnownBakers </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[],</span><span class="s1"> lastKnownUsers </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[],</span><span class="s1"> lastKnownTrades </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[];</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> renderAll</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s7">(!</span><span class="s1">currentUser </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">lastKnownUsers</span><span class="s7">.</span><span class="s1">length</span><span class="s7">)</span><span class="s1"> </span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderDraft</span><span class="s7">(</span><span class="s1">currentLeagueState</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderYourTeam</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderScoreboard</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderAvailableBakers</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderEliminatedBakers</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderTrades</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> renderForPreviewWithoutDb</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> mockDraft </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> status</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'complete'</span><span class="s7">,</span><span class="s1"> draftOrder</span><span class="s7">:</span><span class="s1"> previewUsers</span><span class="s7">,</span><span class="s1"> availableBakers</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[]</span><span class="s1"> </span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> mockUsers </span><span class="s7">=</span><span class="s1"> previewUsers</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">name </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">({</span><span class="s1"> name</span><span class="s7">,</span><span class="s1"> team</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[]}));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> mockBakers </span><span class="s7">=</span><span class="s1"> bakersSeries16</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">name </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">({</span><span class="s1">name</span><span class="s7">,</span><span class="s1"> points</span><span class="s7">:</span><span class="s1"> </span><span class="s14">0</span><span class="s7">,</span><span class="s1"> status</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'active'</span><span class="s7">,</span><span class="s1"> weeklyLog</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[]}));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> tempBakers </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[...</span><span class="s1">bakersSeries16</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>mockUsers</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">user </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">for</span><span class="s7">(</span><span class="s12">let</span><span class="s1"> i</span><span class="s7">=</span><span class="s14">0</span><span class="s7">;</span><span class="s1"> i</span><span class="s7">&lt;</span><span class="s14">3</span><span class="s7">;</span><span class="s1"> i</span><span class="s7">++){</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s7">(</span><span class="s1">tempBakers</span><span class="s7">.</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> user</span><span class="s7">.</span><span class="s1">team</span><span class="s7">.</span><span class="s1">push</span><span class="s7">(</span><span class="s1">tempBakers</span><span class="s7">.</span><span class="s1">splice</span><span class="s7">(</span><span class="s13">Math</span><span class="s7">.</span><span class="s1">floor</span><span class="s7">(</span><span class="s13">Math</span><span class="s7">.</span><span class="s1">random</span><span class="s7">()</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> tempBakers</span><span class="s7">.</span><span class="s1">length</span><span class="s7">),</span><span class="s1"> </span><span class="s14">1</span><span class="s7">)[</span><span class="s14">0</span><span class="s7">]);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>mockDraft</span><span class="s7">.</span><span class="s1">availableBakers </span><span class="s7">=</span><span class="s1"> tempBakers</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>lastKnownBakers </span><span class="s7">=</span><span class="s1"> mockBakers</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>lastKnownUsers </span><span class="s7">=</span><span class="s1"> mockUsers</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentLeagueState </span><span class="s7">=</span><span class="s1"> mockDraft</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderAll</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> renderDraft</span><span class="s7">(</span><span class="s1">draftData</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">draftData </span><span class="s7">||</span><span class="s1"> draftData</span><span class="s7">.</span><span class="s1">status </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'complete'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>draftSection</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s12">const</span><span class="s4"> logWeekButton </span><span class="s7">=</span><span class="s4"> </span><span class="s1">`&lt;button id="log-week-btn" class="gbbo-button"&gt;Log Weekly Results&lt;/button&gt;`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">mode </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> </span><span class="s7">!</span><span class="s1">db</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s10">// For local preview</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span>adminActions</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'&lt;p class="text-slate-500"&gt;Admin actions require a database connection.&lt;/p&gt;'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">mode </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> db</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>adminActions</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> logWeekButton</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">db </span><span class="s7">&amp;&amp;</span><span class="s1"> currentUser </span><span class="s7">===</span><span class="s1"> draftData</span><span class="s7">?.</span><span class="s1">draftOrder</span><span class="s7">?.[</span><span class="s14">0</span><span class="s7">])</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>liveAdminControls</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> logWeekButton</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>getEl</span><span class="s7">(</span><span class="s8">'log-week-btn'</span><span class="s7">)?.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> openLogWeekModal</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>draftSection</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'block'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>draftSection</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'gbbo-card'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> status</span><span class="s7">,</span><span class="s1"> round</span><span class="s7">,</span><span class="s1"> currentPlayer</span><span class="s7">,</span><span class="s1"> draftOrder</span><span class="s7">,</span><span class="s1"> availableBakers </span><span class="s7">}</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> draftData</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> draftTurnInfo </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'draft-turn-info'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> draftMessage </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'draft-message'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> availableBakersDiv </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'available-bakers-draft'</span><span class="s7">);</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">status </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'in-progress'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>draftTurnInfo</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'block'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>draftMessage</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>getEl</span><span class="s7">(</span><span class="s8">'round-number'</span><span class="s7">).</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> round</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>getEl</span><span class="s7">(</span><span class="s8">'current-player'</span><span class="s7">).</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> currentPlayer</span><span class="s7">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>getEl</span><span class="s7">(</span><span class="s1">'draft-order'</span><span class="s7">).</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> draftOrder</span><span class="s7">.</span><span class="s4">map</span><span class="s7">(</span><span class="s4">user </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`&lt;div class="px-4 py-2 rounded-full text-sm </span><span class="s7">${</span><span class="s4">user </span><span class="s7">===</span><span class="s4"> currentPlayer </span><span class="s7">?</span><span class="s4"> </span><span class="s1">'bg-[#d4e6e5] text-[#32aad7] font-semibold'</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">'bg-slate-100'</span><span class="s7">}</span><span class="s1">"&gt;</span><span class="s7">${</span><span class="s4">user</span><span class="s7">}</span><span class="s1">&lt;/div&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>availableBakersDiv</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> availableBakers</span><span class="s7">.</span><span class="s4">map</span><span class="s7">(</span><span class="s4">bakerName </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`&lt;div class="gbbo-card p-4 text-center"&gt;&lt;p class="font-semibold"&gt;</span><span class="s7">${</span><span class="s4">bakerName</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span><span class="s7">${(</span><span class="s4">currentPlayer </span><span class="s7">===</span><span class="s4"> currentUser </span><span class="s7">&amp;&amp;</span><span class="s4"> db</span><span class="s7">)</span><span class="s4"> </span><span class="s7">?</span><span class="s4"> </span><span class="s1">`&lt;button data-baker="</span><span class="s7">${</span><span class="s4">bakerName</span><span class="s7">}</span><span class="s1">" class="draft-btn mt-3 w-full gbbo-button-secondary text-xs !py-1.5 !px-3"&gt;Draft&lt;/button&gt;`</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">''</span><span class="s7">}</span><span class="s1">&lt;/div&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s7">.</span><span class="s1">querySelectorAll</span><span class="s7">(</span><span class="s8">'.draft-btn'</span><span class="s7">).</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">btn </span><span class="s7">=&gt;</span><span class="s1"> btn</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> handleDraftPick</span><span class="s7">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">status </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'not-started'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>draftTurnInfo</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>draftMessage</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'block'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>draftSection</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">(</span><span class="s8">'gbbo-card'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>availableBakersDiv</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">mode </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span>draftMessage</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> </span><span class="s1">`&lt;p class="text-xl text-slate-600"&gt;Auto-simulating draft...&lt;/p&gt;`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">currentUser </span><span class="s7">===</span><span class="s1"> draftOrder</span><span class="s7">[</span><span class="s14">0</span><span class="s7">])</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>draftMessage</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="gbbo-card bg-slate-50/70 p-6 max-w-prose mx-auto text-center"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;h3 class="text-2xl font-bold text-slate-800"&gt;You are the League Admin!&lt;/h3&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="text-slate-600 mt-2"&gt;Share this League ID with your friends:&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="text-2xl font-bold my-2 bg-white p-2 rounded-lg tracking-widest text-[#e45c85]"&gt;</span><span class="s7">${</span><span class="s4">currentLeagueId</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;ul class="text-left list-disc list-inside mt-4 space-y-2 text-slate-600"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;li&gt;Wait for all your friends to join the league. Their names will appear below as they join.&lt;/li&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;li&gt;Once everyone is ready, click "Start Draft" to begin the manual, turn-based selection process.&lt;/li&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;li&gt;Team management (trading, adding/dropping bakers) and score logging will unlock for everyone after the draft is complete.&lt;/li&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/ul&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;`</span><span class="s7">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span>getEl</span><span class="s7">(</span><span class="s1">'draft-order'</span><span class="s7">).</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> draftOrder</span><span class="s7">.</span><span class="s4">map</span><span class="s7">(</span><span class="s4">user </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`&lt;div class="px-4 py-2 rounded-full text-sm bg-slate-100 font-semibold"&gt;</span><span class="s7">${</span><span class="s4">user</span><span class="s7">}</span><span class="s1">&lt;/div&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span>availableBakersDiv</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> </span><span class="s1">`&lt;div class="mt-6"&gt;&lt;button id="start-draft-btn" class="gbbo-button"&gt;Start Draft&lt;/button&gt;&lt;/div&gt;`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>getEl</span><span class="s7">(</span><span class="s8">'start-draft-btn'</span><span class="s7">)?.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> startDraft</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>draftMessage</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="gbbo-card bg-slate-50/70 p-6 max-w-prose mx-auto text-center"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;h3 class="text-2xl font-bold text-slate-800"&gt;Ready to Draft!&lt;/h3&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="text-slate-600 mt-2"&gt;The league is waiting for the admin, &lt;span class="font-bold text-[#e45c85]"&gt;</span><span class="s7">${</span><span class="s4">draftOrder</span><span class="s7">[</span><span class="s14">0</span><span class="s7">]}</span><span class="s1">&lt;/span&gt;, to start the draft.&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="text-slate-600 mt-2"&gt;Make sure all players have joined!&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> renderYourTeam</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> yourTeamDiv </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'your-team'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> user </span><span class="s7">=</span><span class="s1"> lastKnownUsers</span><span class="s7">.</span><span class="s1">find</span><span class="s7">(</span><span class="s1">u </span><span class="s7">=&gt;</span><span class="s1"> u</span><span class="s7">.</span><span class="s1">name </span><span class="s7">===</span><span class="s1"> currentUser</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">user</span><span class="s7">)</span><span class="s1"> </span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">user</span><span class="s7">.</span><span class="s1">team</span><span class="s7">.</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>yourTeamDiv</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> user</span><span class="s7">.</span><span class="s1">team</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">bakerName </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> baker </span><span class="s7">=</span><span class="s1"> lastKnownBakers</span><span class="s7">.</span><span class="s1">find</span><span class="s7">(</span><span class="s1">b </span><span class="s7">=&gt;</span><span class="s1"> b</span><span class="s7">.</span><span class="s1">name </span><span class="s7">===</span><span class="s1"> bakerName</span><span class="s7">)</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> </span><span class="s7">{};</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s4"> weeklyLogHtml </span><span class="s7">=</span><span class="s4"> </span><span class="s7">(</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">weeklyLog </span><span class="s7">||</span><span class="s4"> </span><span class="s7">[]).</span><span class="s4">sort</span><span class="s7">((</span><span class="s4">a</span><span class="s7">,</span><span class="s4"> b</span><span class="s7">)</span><span class="s4"> </span><span class="s7">=&gt;</span><span class="s4"> b</span><span class="s7">.</span><span class="s4">week </span><span class="s7">-</span><span class="s4"> a</span><span class="s7">.</span><span class="s4">week</span><span class="s7">).</span><span class="s4">map</span><span class="s7">(</span><span class="s4">weekData </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`&lt;div class="mt-3"&gt;&lt;h4 class="font-semibold text-slate-700"&gt;Week </span><span class="s7">${</span><span class="s4">weekData</span><span class="s7">.</span><span class="s4">week</span><span class="s7">}</span><span class="s1">&lt;/h4&gt;&lt;ul class="list-disc list-inside text-sm text-slate-600 pl-2 space-y-1"&gt;</span><span class="s7">${</span><span class="s4">weekData</span><span class="s7">.</span><span class="s4">events</span><span class="s7">.</span><span class="s4">map</span><span class="s7">(</span><span class="s4">event </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`&lt;li&gt;&lt;span class="</span><span class="s7">${</span><span class="s4">event</span><span class="s7">.</span><span class="s4">points </span><span class="s7">&gt;=</span><span class="s4"> </span><span class="s14">0</span><span class="s4"> </span><span class="s7">?</span><span class="s4"> </span><span class="s1">'text-green-600'</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">'text-red-600'</span><span class="s7">}</span><span class="s1">"&gt;</span><span class="s7">${</span><span class="s4">event</span><span class="s7">.</span><span class="s4">points </span><span class="s7">&gt;</span><span class="s4"> </span><span class="s14">0</span><span class="s4"> </span><span class="s7">?</span><span class="s4"> </span><span class="s1">'+'</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">''</span><span class="s7">}${</span><span class="s4">event</span><span class="s7">.</span><span class="s4">points</span><span class="s7">}</span><span class="s1">&lt;/span&gt; for </span><span class="s7">${</span><span class="s4">event</span><span class="s7">.</span><span class="s4">reason</span><span class="s7">}</span><span class="s1">&lt;/li&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">)}</span><span class="s1">&lt;/ul&gt;&lt;/div&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s4"> tradeButton </span><span class="s7">=</span><span class="s4"> db </span><span class="s7">?</span><span class="s4"> </span><span class="s1">`&lt;button class="gbbo-button-action" onclick="window.openTradeModal('</span><span class="s7">${</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">')"&gt;&lt;svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"&gt;&lt;path d="m21.73 18-8-14a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/&gt;&lt;path d="M12 4v17"/&gt;&lt;/svg&gt;&lt;span&gt;Trade&lt;/span&gt;&lt;/button&gt;`</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">''</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> actionButtons </span><span class="s7">=</span><span class="s1"> currentLeagueState</span><span class="s7">.</span><span class="s1">status </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'complete'</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> baker</span><span class="s7">.</span><span class="s1">status </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'active'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex items-center space-x-2 mt-4 pt-4 border-t"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;button class="gbbo-button-action" onclick="window.handleDropBaker('</span><span class="s7">${</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">')"&gt;&lt;svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"&gt;&lt;path d="M3 6h18"/&gt;&lt;path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/&gt;&lt;/svg&gt;&lt;span&gt;Drop&lt;/span&gt;&lt;/button&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">${</span><span class="s4">tradeButton</span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>`</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">''</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">return</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="baker-card bg-white rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div class="p-5 cursor-pointer toggle-details"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="font-bold text-lg text-[#32aad7]"&gt;</span><span class="s7">${</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="text-slate-600"&gt;Points: &lt;span class="font-semibold text-xl text-slate-800"&gt;</span><span class="s7">${</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">points </span><span class="s7">||</span><span class="s4"> </span><span class="s14">0</span><span class="s7">}</span><span class="s1">&lt;/span&gt;&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="text-sm </span><span class="s7">${</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">status </span><span class="s7">===</span><span class="s4"> </span><span class="s1">'eliminated'</span><span class="s4"> </span><span class="s7">?</span><span class="s4"> </span><span class="s1">'text-red-500'</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">'text-green-600'</span><span class="s7">}</span><span class="s1"> font-semibold capitalize"&gt;</span><span class="s7">${</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">status</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div class="baker-details hidden bg-slate-50/50 p-5 border-t border-slate-100"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">${</span><span class="s4">weeklyLogHtml </span><span class="s7">||</span><span class="s4"> </span><span class="s1">'&lt;p class="text-sm text-slate-500"&gt;No points awarded yet.&lt;/p&gt;'</span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">${</span><span class="s4">actionButtons</span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}).</span><span class="s1">join</span><span class="s7">(</span><span class="s8">''</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>yourTeamDiv</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> </span><span class="s1">`&lt;div class="col-span-full text-center py-10"&gt;&lt;p class="text-slate-500"&gt;You haven't drafted a team yet.&lt;/p&gt;&lt;/div&gt;`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s1">querySelectorAll</span><span class="s7">(</span><span class="s8">'#your-team .toggle-details'</span><span class="s7">).</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">el </span><span class="s7">=&gt;</span><span class="s1"> el</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> el</span><span class="s7">.</span><span class="s1">nextElementSibling</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">toggle</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">)));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> renderScoreboard</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> scoreboardDiv </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'scoreboard'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> usersWithScores </span><span class="s7">=</span><span class="s1"> lastKnownUsers</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">user </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> teamBakers </span><span class="s7">=</span><span class="s1"> user</span><span class="s7">.</span><span class="s1">team</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">bakerName </span><span class="s7">=&gt;</span><span class="s1"> lastKnownBakers</span><span class="s7">.</span><span class="s1">find</span><span class="s7">(</span><span class="s1">b </span><span class="s7">=&gt;</span><span class="s1"> b</span><span class="s7">.</span><span class="s1">name </span><span class="s7">===</span><span class="s1"> bakerName</span><span class="s7">)).</span><span class="s1">filter</span><span class="s7">(</span><span class="s13">Boolean</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> totalPoints </span><span class="s7">=</span><span class="s1"> teamBakers</span><span class="s7">.</span><span class="s1">reduce</span><span class="s7">((</span><span class="s1">acc</span><span class="s7">,</span><span class="s1"> baker</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> acc </span><span class="s7">+</span><span class="s1"> </span><span class="s7">(</span><span class="s1">baker</span><span class="s7">.</span><span class="s1">points </span><span class="s7">||</span><span class="s1"> </span><span class="s14">0</span><span class="s7">),</span><span class="s1"> </span><span class="s14">0</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s1"> </span><span class="s7">{...</span><span class="s1">user</span><span class="s7">,</span><span class="s1"> totalPoints</span><span class="s7">,</span><span class="s1"> teamBakers</span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>usersWithScores</span><span class="s7">.</span><span class="s1">sort</span><span class="s7">((</span><span class="s1">a</span><span class="s7">,</span><span class="s1">b</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> b</span><span class="s7">.</span><span class="s1">totalPoints </span><span class="s7">-</span><span class="s1"> a</span><span class="s7">.</span><span class="s1">totalPoints</span><span class="s7">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>scoreboardDiv</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> usersWithScores</span><span class="s7">.</span><span class="s1">map</span><span class="s7">((</span><span class="s1">user</span><span class="s7">,</span><span class="s1"> index</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s12">const</span><span class="s4"> teamDetailsHtml </span><span class="s7">=</span><span class="s4"> user</span><span class="s7">.</span><span class="s4">teamBakers</span><span class="s7">.</span><span class="s4">map</span><span class="s7">(</span><span class="s4">bakerData </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`&lt;div class="mt-2 flex justify-between"&gt;&lt;p class="font-semibold text-slate-800"&gt;</span><span class="s7">${</span><span class="s4">bakerData</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/p&gt;&lt;p&gt;</span><span class="s7">${</span><span class="s4">bakerData</span><span class="s7">.</span><span class="s4">points</span><span class="s7">}</span><span class="s1"> pts&lt;/p&gt;&lt;/div&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="gbbo-card overflow-hidden </span><span class="s7">${</span><span class="s4">index </span><span class="s7">===</span><span class="s4"> </span><span class="s14">0</span><span class="s4"> </span><span class="s7">?</span><span class="s4"> </span><span class="s1">'border-2 border-amber-300'</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">''</span><span class="s7">}</span><span class="s1">"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="p-4 cursor-pointer toggle-details"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div class="flex justify-between items-center"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-4"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-xl font-bold text-slate-400 w-6"&gt;</span><span class="s7">${</span><span class="s4">index </span><span class="s7">+</span><span class="s4"> </span><span class="s14">1</span><span class="s7">}</span><span class="s1">.&lt;/span&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;p class="text-xl font-semibold text-slate-800"&gt;</span><span class="s7">${</span><span class="s4">user</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="text-2xl font-bold text-[#e45c85]"&gt;</span><span class="s7">${</span><span class="s4">user</span><span class="s7">.</span><span class="s4">totalPoints</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="baker-details hidden bg-slate-50/50 p-4 border-t"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;h4 class="font-bold text-md mb-2"&gt;Team&lt;/h4&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">${</span><span class="s4">teamDetailsHtml </span><span class="s7">||</span><span class="s4"> </span><span class="s1">''</span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;`</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}).</span><span class="s1">join</span><span class="s7">(</span><span class="s8">''</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s1">querySelectorAll</span><span class="s7">(</span><span class="s8">'#scoreboard .toggle-details'</span><span class="s7">).</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">el </span><span class="s7">=&gt;</span><span class="s1"> el</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> el</span><span class="s7">.</span><span class="s1">nextElementSibling</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">toggle</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">)));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> renderAvailableBakers</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> faSection </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'free-agents-section'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">currentLeagueState</span><span class="s7">.</span><span class="s1">status </span><span class="s7">!==</span><span class="s1"> </span><span class="s8">'complete'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>faSection</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>faSection</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'block'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> availableBakersDiv </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'available-bakers-fa'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> user </span><span class="s7">=</span><span class="s1"> lastKnownUsers</span><span class="s7">.</span><span class="s1">find</span><span class="s7">(</span><span class="s1">u </span><span class="s7">=&gt;</span><span class="s1"> u</span><span class="s7">.</span><span class="s1">name </span><span class="s7">===</span><span class="s1"> currentUser</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> canAdd </span><span class="s7">=</span><span class="s1"> user </span><span class="s7">&amp;&amp;</span><span class="s1"> user</span><span class="s7">.</span><span class="s1">team</span><span class="s7">.</span><span class="s1">length </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s14">3</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">currentLeagueState</span><span class="s7">.</span><span class="s1">availableBakers </span><span class="s7">&amp;&amp;</span><span class="s1"> currentLeagueState</span><span class="s7">.</span><span class="s1">availableBakers</span><span class="s7">.</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>availableBakersDiv</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> currentLeagueState</span><span class="s7">.</span><span class="s1">availableBakers</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">bakerName </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                     </span>&lt;div class="gbbo-card p-3 text-center transition-all hover:shadow-md"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p class="font-semibold text-sm"&gt;</span><span class="s7">${</span><span class="s4">bakerName</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">${</span><span class="s4">canAdd </span><span class="s7">?</span><span class="s4"> </span><span class="s1">`&lt;button class="mt-2 w-full gbbo-button-action" onclick="window.handleAddBaker('</span><span class="s7">${</span><span class="s4">bakerName</span><span class="s7">}</span><span class="s1">')"&gt;&lt;svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"&gt;&lt;line x1="12" y1="5" x2="12" y2="19"&gt;&lt;/line&gt;&lt;line x1="5" y1="12" x2="19" y2="12"&gt;&lt;/line&gt;&lt;/svg&gt;&lt;span&gt;Add&lt;/span&gt;&lt;/button&gt;`</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">''</span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>availableBakersDiv</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> </span><span class="s1">`&lt;p class="text-slate-500 col-span-full"&gt;No bakers are available.&lt;/p&gt;`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> renderEliminatedBakers</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> eliminatedSection </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'eliminated-bakers-section'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">currentLeagueState</span><span class="s7">.</span><span class="s1">status </span><span class="s7">!==</span><span class="s1"> </span><span class="s8">'complete'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>eliminatedSection</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>eliminatedSection</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'block'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> eliminatedBakersDiv </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'eliminated-bakers'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> eliminated </span><span class="s7">=</span><span class="s1"> lastKnownBakers</span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">b </span><span class="s7">=&gt;</span><span class="s1"> b</span><span class="s7">.</span><span class="s1">status </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'eliminated'</span><span class="s7">);</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s7">(</span><span class="s1">eliminated</span><span class="s7">.</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span>eliminatedBakersDiv</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> eliminated</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">baker </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="p-3 bg-slate-100 rounded-lg text-center text-slate-500 line-through"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p class="font-semibold text-sm"&gt;</span><span class="s7">${</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                 </span>eliminatedBakersDiv</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> </span><span class="s1">`&lt;p class="text-slate-500"&gt;No bakers have been eliminated yet.&lt;/p&gt;`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> renderTrades</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s12">const</span><span class="s1"> tradesSection </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'trades-section'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">currentLeagueState</span><span class="s7">.</span><span class="s1">status </span><span class="s7">!==</span><span class="s1"> </span><span class="s8">'complete'</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">db</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>tradesSection</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>tradesSection</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'block'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> container </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'trades-container'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> incoming </span><span class="s7">=</span><span class="s1"> lastKnownTrades</span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">t </span><span class="s7">=&gt;</span><span class="s1"> t</span><span class="s7">.</span><span class="s1">toUser </span><span class="s7">===</span><span class="s1"> currentUser</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> outgoing </span><span class="s7">=</span><span class="s1"> lastKnownTrades</span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">t </span><span class="s7">=&gt;</span><span class="s1"> t</span><span class="s7">.</span><span class="s1">fromUser </span><span class="s7">===</span><span class="s1"> currentUser</span><span class="s7">);</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s4"> html </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'&lt;div class="space-y-6"&gt;'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">incoming</span><span class="s7">.</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>html </span><span class="s7">+=</span><span class="s4"> </span><span class="s1">'&lt;div&gt;&lt;h3 class="font-bold text-xl text-slate-800 mb-3"&gt;Incoming Proposals&lt;/h3&gt;&lt;div class="space-y-3"&gt;'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>html </span><span class="s7">+=</span><span class="s1"> incoming</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">trade </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="gbbo-card p-4"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p&gt;&lt;span class="font-semibold"&gt;</span><span class="s7">${</span><span class="s4">trade</span><span class="s7">.</span><span class="s4">fromUser</span><span class="s7">}</span><span class="s1">&lt;/span&gt; wants to trade their &lt;span class="font-semibold text-[#32aad7]"&gt;</span><span class="s7">${</span><span class="s4">trade</span><span class="s7">.</span><span class="s4">fromBaker</span><span class="s7">}</span><span class="s1">&lt;/span&gt; for your &lt;span class="font-semibold text-[#32aad7]"&gt;</span><span class="s7">${</span><span class="s4">trade</span><span class="s7">.</span><span class="s4">toBaker</span><span class="s7">}</span><span class="s1">&lt;/span&gt;.&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex items-center space-x-2 mt-3"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button class="gbbo-button-action !bg-green-100 !text-green-800" onclick="window.handleAcceptTrade('</span><span class="s7">${</span><span class="s4">trade</span><span class="s7">.</span><span class="s4">id</span><span class="s7">}</span><span class="s1">')"&gt;Accept&lt;/button&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button class="gbbo-button-action !bg-red-100 !text-red-800" onclick="window.handleRejectTrade('</span><span class="s7">${</span><span class="s4">trade</span><span class="s7">.</span><span class="s4">id</span><span class="s7">}</span><span class="s1">')"&gt;Reject&lt;/button&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>html </span><span class="s7">+=</span><span class="s1"> </span><span class="s8">'&lt;/div&gt;&lt;/div&gt;'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">outgoing</span><span class="s7">.</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>html </span><span class="s7">+=</span><span class="s4"> </span><span class="s1">'&lt;div&gt;&lt;h3 class="font-bold text-xl text-slate-800 mb-3"&gt;Outgoing Proposals&lt;/h3&gt;&lt;div class="space-y-3"&gt;'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>html </span><span class="s7">+=</span><span class="s1"> outgoing</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">trade </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="gbbo-card p-4"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p&gt;You offered to trade your &lt;span class="font-semibold text-[#32aad7]"&gt;</span><span class="s7">${</span><span class="s4">trade</span><span class="s7">.</span><span class="s4">fromBaker</span><span class="s7">}</span><span class="s1">&lt;/span&gt; for &lt;span class="font-semibold"&gt;</span><span class="s7">${</span><span class="s4">trade</span><span class="s7">.</span><span class="s4">toUser</span><span class="s7">}</span><span class="s1">&lt;/span&gt;'s &lt;span class="font-semibold text-[#32aad7]"&gt;</span><span class="s7">${</span><span class="s4">trade</span><span class="s7">.</span><span class="s4">toBaker</span><span class="s7">}</span><span class="s1">&lt;/span&gt;.&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;div class="mt-3"&gt;&lt;button class="gbbo-button-action" onclick="window.handleCancelTrade('</span><span class="s7">${</span><span class="s4">trade</span><span class="s7">.</span><span class="s4">id</span><span class="s7">}</span><span class="s1">')"&gt;Cancel&lt;/button&gt;&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>html </span><span class="s7">+=</span><span class="s1"> </span><span class="s8">'&lt;/div&gt;&lt;/div&gt;'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">incoming</span><span class="s7">.</span><span class="s1">length </span><span class="s7">===</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> outgoing</span><span class="s7">.</span><span class="s1">length </span><span class="s7">===</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>html </span><span class="s7">+=</span><span class="s4"> </span><span class="s1">'&lt;p class="text-slate-500"&gt;No pending trades.&lt;/p&gt;'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>html </span><span class="s7">+=</span><span class="s1"> </span><span class="s8">'&lt;/div&gt;'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>container</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> html</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- TEAM MANAGEMENT ACTIONS ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s7">.</span><span class="s1">handleDropBaker </span><span class="s7">=</span><span class="s1"> </span><span class="s12">async</span><span class="s1"> </span><span class="s7">(</span><span class="s1">bakerName</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s10">/* ... same as previous step ... */</span><span class="s1"> </span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s7">.</span><span class="s1">handleAddBaker </span><span class="s7">=</span><span class="s1"> </span><span class="s12">async</span><span class="s1"> </span><span class="s7">(</span><span class="s1">bakerName</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s10">/* ... same as previous step ... */</span><span class="s1"> </span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s7">.</span><span class="s1">openTradeModal </span><span class="s7">=</span><span class="s1"> </span><span class="s7">(</span><span class="s1">bakerToTrade</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s10">/* ... same as previous step ... */</span><span class="s1"> </span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> handleProposeTrade</span><span class="s7">(</span><span class="s1">e</span><span class="s7">,</span><span class="s1"> fromBaker</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s10">/* ... same as previous step ... */</span><span class="s1"> </span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s7">.</span><span class="s1">handleAcceptTrade </span><span class="s7">=</span><span class="s1"> </span><span class="s12">async</span><span class="s1"> </span><span class="s7">(</span><span class="s1">tradeId</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s10">/* ... same as previous step ... */</span><span class="s1"> </span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s7">.</span><span class="s1">handleRejectTrade </span><span class="s7">=</span><span class="s1"> </span><span class="s12">async</span><span class="s1"> </span><span class="s7">(</span><span class="s1">tradeId</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s10">/* ... same as previous step ... */</span><span class="s1"> </span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s7">.</span><span class="s1">handleCancelTrade </span><span class="s7">=</span><span class="s1"> </span><span class="s12">async</span><span class="s1"> </span><span class="s7">(</span><span class="s1">tradeId</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s10">/* ... same as previous step ... */</span><span class="s1"> </span><span class="s7">};</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- DRAFT &amp; WEEKLY LOGIC ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> simulateDraft</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueId </span><span class="s7">=</span><span class="s1"> mode </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> currentLeagueId</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">db</span><span class="s7">)</span><span class="s1"> </span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leaguePath </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/leagues/</span><span class="s7">${</span><span class="s1">leagueId</span><span class="s7">}</span><span class="s8">`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> leaguePath</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> usersRef </span><span class="s7">=</span><span class="s1"> collection</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`</span><span class="s7">${</span><span class="s1">leaguePath</span><span class="s7">}</span><span class="s8">/users`</span><span class="s7">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueSnap </span><span class="s7">=</span><span class="s1"> </span><span class="s12">await</span><span class="s1"> getDoc</span><span class="s7">(</span><span class="s1">leagueRef</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">leagueSnap</span><span class="s7">.</span><span class="s1">exists</span><span class="s7">())</span><span class="s1"> </span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> usersSnap </span><span class="s7">=</span><span class="s1"> </span><span class="s12">await</span><span class="s1"> getDocs</span><span class="s7">(</span><span class="s1">usersRef</span><span class="s7">);</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> batch </span><span class="s7">=</span><span class="s1"> writeBatch</span><span class="s7">(</span><span class="s1">db</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> availableBakers</span><span class="s7">,</span><span class="s1"> draftOrder </span><span class="s7">}</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> leagueSnap</span><span class="s7">.</span><span class="s1">data</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> usersData </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>usersSnap</span><span class="s7">.</span><span class="s1">docs</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">d </span><span class="s7">=&gt;</span><span class="s1"> usersData</span><span class="s7">[</span><span class="s1">d</span><span class="s7">.</span><span class="s1">id</span><span class="s7">]</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> d</span><span class="s7">.</span><span class="s1">data</span><span class="s7">());</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> </span><span class="s7">(</span><span class="s12">let</span><span class="s1"> round </span><span class="s7">=</span><span class="s1"> </span><span class="s14">1</span><span class="s7">;</span><span class="s1"> round </span><span class="s7">&lt;=</span><span class="s1"> </span><span class="s14">3</span><span class="s7">;</span><span class="s1"> round</span><span class="s7">++)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">for</span><span class="s1"> </span><span class="s7">(</span><span class="s12">const</span><span class="s1"> userName </span><span class="s12">of</span><span class="s1"> draftOrder</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">availableBakers</span><span class="s7">.</span><span class="s1">length </span><span class="s7">===</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s12">break</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> pickedBaker </span><span class="s7">=</span><span class="s1"> availableBakers</span><span class="s7">.</span><span class="s1">splice</span><span class="s7">(</span><span class="s13">Math</span><span class="s7">.</span><span class="s1">floor</span><span class="s7">(</span><span class="s13">Math</span><span class="s7">.</span><span class="s1">random</span><span class="s7">()</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> availableBakers</span><span class="s7">.</span><span class="s1">length</span><span class="s7">),</span><span class="s1"> </span><span class="s14">1</span><span class="s7">)[</span><span class="s14">0</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">usersData</span><span class="s7">[</span><span class="s1">userName</span><span class="s7">])</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">usersData</span><span class="s7">[</span><span class="s1">userName</span><span class="s7">].</span><span class="s1">team</span><span class="s7">)</span><span class="s1"> usersData</span><span class="s7">[</span><span class="s1">userName</span><span class="s7">].</span><span class="s1">team </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>usersData</span><span class="s7">[</span><span class="s1">userName</span><span class="s7">].</span><span class="s1">team</span><span class="s7">.</span><span class="s1">push</span><span class="s7">(</span><span class="s1">pickedBaker</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>draftOrder</span><span class="s7">.</span><span class="s1">sort</span><span class="s7">(()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s13">Math</span><span class="s7">.</span><span class="s1">random</span><span class="s7">()</span><span class="s1"> </span><span class="s7">-</span><span class="s1"> </span><span class="s14">0.5</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> </span><span class="s7">(</span><span class="s12">const</span><span class="s1"> userName </span><span class="s12">in</span><span class="s1"> usersData</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>batch</span><span class="s7">.</span><span class="s1">update</span><span class="s7">(</span><span class="s1">doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`</span><span class="s7">${</span><span class="s1">leaguePath</span><span class="s7">}</span><span class="s8">/users/</span><span class="s7">${</span><span class="s1">userName</span><span class="s7">}</span><span class="s8">`</span><span class="s7">),</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> team</span><span class="s7">:</span><span class="s1"> usersData</span><span class="s7">[</span><span class="s1">userName</span><span class="s7">].</span><span class="s1">team </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>batch</span><span class="s7">.</span><span class="s1">update</span><span class="s7">(</span><span class="s1">leagueRef</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> status</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'complete'</span><span class="s7">,</span><span class="s1"> availableBakers</span><span class="s7">,</span><span class="s1"> round</span><span class="s7">:</span><span class="s1"> </span><span class="s14">4</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">await</span><span class="s1"> batch</span><span class="s7">.</span><span class="s1">commit</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> startDraft</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueId </span><span class="s7">=</span><span class="s1"> mode </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> currentLeagueId</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s7">(!</span><span class="s1">db</span><span class="s7">)</span><span class="s1"> </span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/leagues/</span><span class="s7">${</span><span class="s1">leagueId</span><span class="s7">}</span><span class="s8">`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">await</span><span class="s1"> setDoc</span><span class="s7">(</span><span class="s1">leagueRef</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> status</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'in-progress'</span><span class="s1"> </span><span class="s7">},</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> merge</span><span class="s7">:</span><span class="s1"> </span><span class="s12">true</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> handleDraftPick</span><span class="s7">(</span><span class="s1">e</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueId </span><span class="s7">=</span><span class="s1"> mode </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> currentLeagueId</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s7">(!</span><span class="s1">db</span><span class="s7">)</span><span class="s1"> </span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> bakerName </span><span class="s7">=</span><span class="s1"> e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">dataset</span><span class="s7">.</span><span class="s1">baker</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/leagues/</span><span class="s7">${</span><span class="s1">leagueId</span><span class="s7">}</span><span class="s8">`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> userRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/leagues/</span><span class="s7">${</span><span class="s1">leagueId</span><span class="s7">}</span><span class="s8">/users/</span><span class="s7">${</span><span class="s1">currentUser</span><span class="s7">}</span><span class="s8">`</span><span class="s7">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueSnap </span><span class="s7">=</span><span class="s1"> </span><span class="s12">await</span><span class="s1"> getDoc</span><span class="s7">(</span><span class="s1">leagueRef</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">leagueSnap</span><span class="s7">.</span><span class="s1">exists</span><span class="s7">()</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> leagueSnap</span><span class="s7">.</span><span class="s1">data</span><span class="s7">().</span><span class="s1">currentPlayer </span><span class="s7">!==</span><span class="s1"> currentUser</span><span class="s7">)</span><span class="s1"> </span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueData </span><span class="s7">=</span><span class="s1"> leagueSnap</span><span class="s7">.</span><span class="s1">data</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> round</span><span class="s7">,</span><span class="s1"> draftOrder</span><span class="s7">,</span><span class="s1"> availableBakers </span><span class="s7">}</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> leagueData</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> userSnap </span><span class="s7">=</span><span class="s1"> </span><span class="s12">await</span><span class="s1"> getDoc</span><span class="s7">(</span><span class="s1">userRef</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">await</span><span class="s1"> setDoc</span><span class="s7">(</span><span class="s1">userRef</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> team</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[...(</span><span class="s1">userSnap</span><span class="s7">.</span><span class="s1">data</span><span class="s7">().</span><span class="s1">team </span><span class="s7">||</span><span class="s1"> </span><span class="s7">[]),</span><span class="s1"> bakerName</span><span class="s7">]</span><span class="s1"> </span><span class="s7">},</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> merge</span><span class="s7">:</span><span class="s1"> </span><span class="s12">true</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>availableBakers </span><span class="s7">=</span><span class="s1"> availableBakers</span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">b </span><span class="s7">=&gt;</span><span class="s1"> b </span><span class="s7">!==</span><span class="s1"> bakerName</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> nextPlayerIndex </span><span class="s7">=</span><span class="s1"> </span><span class="s7">(</span><span class="s1">draftOrder</span><span class="s7">.</span><span class="s1">indexOf</span><span class="s7">(</span><span class="s1">currentUser</span><span class="s7">)</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> </span><span class="s14">1</span><span class="s7">)</span><span class="s1"> </span><span class="s7">%</span><span class="s1"> draftOrder</span><span class="s7">.</span><span class="s1">length</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> newCurrentPlayer </span><span class="s7">=</span><span class="s1"> draftOrder</span><span class="s7">[</span><span class="s1">nextPlayerIndex</span><span class="s7">];</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">nextPlayerIndex </span><span class="s7">===</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>round</span><span class="s7">++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">round </span><span class="s7">&lt;=</span><span class="s1"> </span><span class="s14">3</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>draftOrder </span><span class="s7">=</span><span class="s1"> draftOrder</span><span class="s7">.</span><span class="s1">sort</span><span class="s7">(()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s13">Math</span><span class="s7">.</span><span class="s1">random</span><span class="s7">()</span><span class="s1"> </span><span class="s7">-</span><span class="s1"> </span><span class="s14">0.5</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>newCurrentPlayer </span><span class="s7">=</span><span class="s1"> draftOrder</span><span class="s7">[</span><span class="s14">0</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">round </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s14">3</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">await</span><span class="s1"> setDoc</span><span class="s7">(</span><span class="s1">leagueRef</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> status</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'complete'</span><span class="s7">,</span><span class="s1"> availableBakers </span><span class="s7">},</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> merge</span><span class="s7">:</span><span class="s1"> </span><span class="s12">true</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">await</span><span class="s1"> setDoc</span><span class="s7">(</span><span class="s1">leagueRef</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> availableBakers</span><span class="s7">,</span><span class="s1"> round</span><span class="s7">,</span><span class="s1"> draftOrder</span><span class="s7">,</span><span class="s1"> currentPlayer</span><span class="s7">:</span><span class="s1"> newCurrentPlayer </span><span class="s7">},</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> merge</span><span class="s7">:</span><span class="s1"> </span><span class="s12">true</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> openLogWeekModal</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> activeBakers </span><span class="s7">=</span><span class="s1"> lastKnownBakers</span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">b </span><span class="s7">=&gt;</span><span class="s1"> b</span><span class="s7">.</span><span class="s1">status </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'active'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> nextWeek </span><span class="s7">=</span><span class="s1"> </span><span class="s7">(</span><span class="s1">currentLeagueState</span><span class="s7">.</span><span class="s1">week </span><span class="s7">||</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> </span><span class="s14">1</span><span class="s7">;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> bonusSection </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s4"> </span><span class="s7">(</span><span class="s4">nextWeek </span><span class="s7">&gt;=</span><span class="s4"> </span><span class="s14">8</span><span class="s7">)</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> </span><span class="s1">// Assuming semi-finals start around week 8</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>bonusSection </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;h3 class="font-semibold text-xl mb-3 border-b pb-2 text-blue-600"&gt;End of Season Bonuses (One-time)&lt;/h3&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="space-y-4"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;label class="block text-sm font-medium text-slate-700"&gt;Semi-Finalists (+3 pts each)&lt;/label&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;div id="semi-finalists-list" class="mt-2 grid grid-cols-2 md:grid-cols-3 gap-2"&gt;&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;label class="block text-sm font-medium text-slate-700"&gt;Finalists (+6 pts each)&lt;/label&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;div id="finalists-list" class="mt-2 grid grid-cols-2 md:grid-cols-3 gap-2"&gt;&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;label for="season-winner" class="block text-sm font-medium text-slate-700"&gt;Season Winner (+10 pts)&lt;/label&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;select id="season-winner" class="mt-1 block w-full rounded-full border-slate-300 shadow-sm py-2 px-3"&gt;&lt;/select&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> modalHtml </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white rounded-2xl shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;form id="weekly-log-form" class="p-8"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex justify-between items-start mb-6"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;h2 class="text-3xl font-bold text-slate-800"&gt;Log Results for Week </span><span class="s7">${</span><span class="s4">nextWeek</span><span class="s7">}</span><span class="s1">&lt;/h2&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button type="button" class="text-slate-400 hover:text-slate-600 text-3xl leading-none" onclick="document.getElementById('weekly-log-modal').style.display='none'"&gt;&amp;times;&lt;/button&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="space-y-8"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;h3 class="font-semibold text-xl mb-3 border-b pb-2"&gt;Unique Awards&lt;/h3&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;div class="grid grid-cols-1 md:grid-cols-3 gap-4"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;label for="star-baker" class="block text-sm font-medium text-slate-700"&gt;Star Baker (+5)&lt;/label&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;select id="star-baker" class="mt-1 block w-full rounded-full border-slate-300 shadow-sm py-2 px-3"&gt;&lt;/select&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;label for="tech-winner" class="block text-sm font-medium text-slate-700"&gt;Technical Winner (+3)&lt;/label&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;select id="tech-winner" class="mt-1 block w-full rounded-full border-slate-300 shadow-sm py-2 px-3"&gt;&lt;/select&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;label for="tech-loser" class="block text-sm font-medium text-slate-700"&gt;Technical Loser (-2)&lt;/label&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;select id="tech-loser" class="mt-1 block w-full rounded-full border-slate-300 shadow-sm py-2 px-3"&gt;&lt;/select&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;h3 class="font-semibold text-xl mb-3 border-b pb-2"&gt;Individual Events&lt;/h3&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;div id="baker-events-list" class="space-y-4"&gt;&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">${</span><span class="s4">bonusSection</span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;h3 class="font-semibold text-xl mb-3 border-b pb-2 text-red-600"&gt;Elimination&lt;/h3&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                 </span>&lt;div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;label for="eliminated-baker" class="block text-sm font-medium text-slate-700"&gt;Who was eliminated this week?&lt;/label&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;select id="eliminated-baker" class="mt-1 block w-full rounded-full border-slate-300 shadow-sm py-2 px-3"&gt;&lt;/select&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="mt-8 flex justify-end space-x-3"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button type="button" class="gbbo-button-secondary" onclick="document.getElementById('weekly-log-modal').style.display='none'"&gt;Cancel&lt;/button&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button type="submit" class="gbbo-button"&gt;Submit Results&lt;/button&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/form&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>weeklyLogModal</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> modalHtml</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s4"> bakerOptions </span><span class="s7">=</span><span class="s4"> </span><span class="s1">`&lt;option value=""&gt;-- None --&lt;/option&gt;`</span><span class="s4"> </span><span class="s7">+</span><span class="s4"> activeBakers</span><span class="s7">.</span><span class="s4">map</span><span class="s7">(</span><span class="s4">b </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`&lt;option value="</span><span class="s7">${</span><span class="s4">b</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">"&gt;</span><span class="s7">${</span><span class="s4">b</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/option&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getEl</span><span class="s7">(</span><span class="s8">'star-baker'</span><span class="s7">).</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> bakerOptions</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getEl</span><span class="s7">(</span><span class="s8">'tech-winner'</span><span class="s7">).</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> bakerOptions</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getEl</span><span class="s7">(</span><span class="s8">'tech-loser'</span><span class="s7">).</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> bakerOptions</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getEl</span><span class="s7">(</span><span class="s8">'eliminated-baker'</span><span class="s7">).</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> bakerOptions</span><span class="s7">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">nextWeek </span><span class="s7">&gt;=</span><span class="s1"> </span><span class="s14">8</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> allBakers </span><span class="s7">=</span><span class="s1"> lastKnownBakers</span><span class="s7">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>getEl</span><span class="s7">(</span><span class="s1">'semi-finalists-list'</span><span class="s7">).</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> allBakers</span><span class="s7">.</span><span class="s4">filter</span><span class="s7">(</span><span class="s4">b </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s7">!</span><span class="s4">b</span><span class="s7">.</span><span class="s4">hasSemiFinalBonus</span><span class="s7">).</span><span class="s4">map</span><span class="s7">(</span><span class="s4">b </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`&lt;label class="flex items-center space-x-2 text-sm"&gt;&lt;input type="checkbox" name="semi-finalist" data-baker="</span><span class="s7">${</span><span class="s4">b</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">" class="rounded text-[#e45c85] focus:ring-[#e45c85]"&gt;&lt;span&gt;</span><span class="s7">${</span><span class="s4">b</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/span&gt;&lt;/label&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>getEl</span><span class="s7">(</span><span class="s1">'finalists-list'</span><span class="s7">).</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> allBakers</span><span class="s7">.</span><span class="s4">filter</span><span class="s7">(</span><span class="s4">b </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s7">!</span><span class="s4">b</span><span class="s7">.</span><span class="s4">hasFinalistBonus</span><span class="s7">).</span><span class="s4">map</span><span class="s7">(</span><span class="s4">b </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`&lt;label class="flex items-center space-x-2 text-sm"&gt;&lt;input type="checkbox" name="finalist" data-baker="</span><span class="s7">${</span><span class="s4">b</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">" class="rounded text-[#e45c85] focus:ring-[#e45c85]"&gt;&lt;span&gt;</span><span class="s7">${</span><span class="s4">b</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/span&gt;&lt;/label&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>getEl</span><span class="s7">(</span><span class="s1">'season-winner'</span><span class="s7">).</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> </span><span class="s1">`&lt;option value=""&gt;-- None --&lt;/option&gt;`</span><span class="s4"> </span><span class="s7">+</span><span class="s4"> allBakers</span><span class="s7">.</span><span class="s4">filter</span><span class="s7">(</span><span class="s4">b </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s7">!</span><span class="s4">b</span><span class="s7">.</span><span class="s4">isWinner</span><span class="s7">).</span><span class="s4">map</span><span class="s7">(</span><span class="s4">b </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`&lt;option value="</span><span class="s7">${</span><span class="s4">b</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">"&gt;</span><span class="s7">${</span><span class="s4">b</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/option&gt;`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getEl</span><span class="s7">(</span><span class="s8">'baker-events-list'</span><span class="s7">).</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> activeBakers</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">baker </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="p-4 bg-slate-50 rounded-xl border"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;p class="font-semibold"&gt;</span><span class="s7">${</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="grid grid-cols-2 sm:grid-cols-4 gap-x-4 gap-y-2 mt-2"&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label class="flex items-center space-x-2 text-sm"&gt;&lt;input type="checkbox" data-baker="</span><span class="s7">${</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">" data-event="handshake" class="rounded text-[#e45c85] focus:ring-[#e45c85]"&gt;&lt;span&gt;Handshake (+5)&lt;/span&gt;&lt;/label&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label class="flex items-center space-x-2 text-sm"&gt;&lt;input type="checkbox" data-baker="</span><span class="s7">${</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">" data-event="crying" class="rounded text-[#e45c85] focus:ring-[#e45c85]"&gt;&lt;span&gt;Crying (+1)&lt;/span&gt;&lt;/label&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label class="flex items-center space-x-2 text-sm"&gt;&lt;input type="checkbox" data-baker="</span><span class="s7">${</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">" data-event="helping" class="rounded text-[#e45c85] focus:ring-[#e45c85]"&gt;&lt;span&gt;Helping (+2)&lt;/span&gt;&lt;/label&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label class="flex items-center space-x-2 text-sm"&gt;&lt;input type="checkbox" data-baker="</span><span class="s7">${</span><span class="s4">baker</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">" data-event="starting_over" class="rounded text-[#e45c85] focus:ring-[#e45c85]"&gt;&lt;span&gt;Started Over (+1)&lt;/span&gt;&lt;/label&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getEl</span><span class="s7">(</span><span class="s8">'weekly-log-form'</span><span class="s7">).</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'submit'</span><span class="s7">,</span><span class="s1"> handleWeekLogSubmit</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>weeklyLogModal</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'flex'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> handleWeekLogSubmit</span><span class="s7">(</span><span class="s1">e</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>e</span><span class="s7">.</span><span class="s1">preventDefault</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">db</span><span class="s7">)</span><span class="s1"> </span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueId </span><span class="s7">=</span><span class="s1"> mode </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'preview'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> currentLeagueId</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leaguePath </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/leagues/</span><span class="s7">${</span><span class="s1">leagueId</span><span class="s7">}</span><span class="s8">`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> bakersCollectionPath </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span><span class="s7">${</span><span class="s1">leaguePath</span><span class="s7">}</span><span class="s8">/bakers`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> leaguePath</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> batch </span><span class="s7">=</span><span class="s1"> writeBatch</span><span class="s7">(</span><span class="s1">db</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> nextWeek </span><span class="s7">=</span><span class="s1"> </span><span class="s7">(</span><span class="s1">currentLeagueState</span><span class="s7">.</span><span class="s1">week </span><span class="s7">||</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> </span><span class="s14">1</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> weeklyLogs </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>lastKnownBakers</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">b </span><span class="s7">=&gt;</span><span class="s1"> weeklyLogs</span><span class="s7">[</span><span class="s1">b</span><span class="s7">.</span><span class="s1">name</span><span class="s7">]</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[]);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s4"> pointValues </span><span class="s7">=</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> </span><span class="s1">'Star Baker'</span><span class="s7">:</span><span class="s4"> </span><span class="s14">5</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'Winning the Technical'</span><span class="s7">:</span><span class="s4"> </span><span class="s14">3</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'Last in the Technical'</span><span class="s7">:</span><span class="s4"> </span><span class="s7">-</span><span class="s14">2</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'handshake'</span><span class="s7">:</span><span class="s4"> </span><span class="s14">5</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'crying'</span><span class="s7">:</span><span class="s4"> </span><span class="s14">1</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'helping'</span><span class="s7">:</span><span class="s4"> </span><span class="s14">2</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'starting_over'</span><span class="s7">:</span><span class="s4"> </span><span class="s14">1</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'semi-final'</span><span class="s7">:</span><span class="s4"> </span><span class="s14">3</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'final'</span><span class="s7">:</span><span class="s4"> </span><span class="s14">6</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'winner'</span><span class="s7">:</span><span class="s4"> </span><span class="s14">10</span><span class="s4"> </span><span class="s7">};</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> starBaker </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'star-baker'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">starBaker</span><span class="s7">)</span><span class="s1"> weeklyLogs</span><span class="s7">[</span><span class="s1">starBaker</span><span class="s7">].</span><span class="s1">push</span><span class="s7">({</span><span class="s1"> reason</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'Star Baker'</span><span class="s7">,</span><span class="s1"> points</span><span class="s7">:</span><span class="s1"> pointValues</span><span class="s7">[</span><span class="s8">'Star Baker'</span><span class="s7">]</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> techWinner </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'tech-winner'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">techWinner</span><span class="s7">)</span><span class="s1"> weeklyLogs</span><span class="s7">[</span><span class="s1">techWinner</span><span class="s7">].</span><span class="s1">push</span><span class="s7">({</span><span class="s1"> reason</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'Winning the Technical'</span><span class="s7">,</span><span class="s1"> points</span><span class="s7">:</span><span class="s1"> pointValues</span><span class="s7">[</span><span class="s8">'Winning the Technical'</span><span class="s7">]</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> techLoser </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'tech-loser'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">techLoser</span><span class="s7">)</span><span class="s1"> weeklyLogs</span><span class="s7">[</span><span class="s1">techLoser</span><span class="s7">].</span><span class="s1">push</span><span class="s7">({</span><span class="s1"> reason</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'Last in the Technical'</span><span class="s7">,</span><span class="s1"> points</span><span class="s7">:</span><span class="s1"> pointValues</span><span class="s7">[</span><span class="s8">'Last in the Technical'</span><span class="s7">]</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s4">querySelectorAll</span><span class="s7">(</span><span class="s1">'#baker-events-list input[type="checkbox"]:checked'</span><span class="s7">).</span><span class="s4">forEach</span><span class="s7">(</span><span class="s4">box </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> bakerName </span><span class="s7">=</span><span class="s1"> box</span><span class="s7">.</span><span class="s1">dataset</span><span class="s7">.</span><span class="s1">baker</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> eventType </span><span class="s7">=</span><span class="s1"> box</span><span class="s7">.</span><span class="s1">dataset</span><span class="s7">.</span><span class="s1">event</span><span class="s7">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s4"> reasonMap </span><span class="s7">=</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> </span><span class="s1">'handshake'</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Paul Hollywood Handshake'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'crying'</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Crying'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'helping'</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Helping Another Baker'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'starting_over'</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Starting Over'</span><span class="s4"> </span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>weeklyLogs</span><span class="s7">[</span><span class="s1">bakerName</span><span class="s7">].</span><span class="s1">push</span><span class="s7">({</span><span class="s1"> reason</span><span class="s7">:</span><span class="s1"> reasonMap</span><span class="s7">[</span><span class="s1">eventType</span><span class="s7">],</span><span class="s1"> points</span><span class="s7">:</span><span class="s1"> pointValues</span><span class="s7">[</span><span class="s1">eventType</span><span class="s7">]</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Process bonuses</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s1">querySelectorAll</span><span class="s7">(</span><span class="s8">'input[name="semi-finalist"]:checked'</span><span class="s7">).</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">box </span><span class="s7">=&gt;</span><span class="s1"> weeklyLogs</span><span class="s7">[</span><span class="s1">box</span><span class="s7">.</span><span class="s1">dataset</span><span class="s7">.</span><span class="s1">baker</span><span class="s7">].</span><span class="s1">push</span><span class="s7">({</span><span class="s1"> reason</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'Made it to Semi-Finals'</span><span class="s7">,</span><span class="s1"> points</span><span class="s7">:</span><span class="s1"> pointValues</span><span class="s7">[</span><span class="s8">'semi-final'</span><span class="s7">]</span><span class="s1"> </span><span class="s7">}));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s1">querySelectorAll</span><span class="s7">(</span><span class="s8">'input[name="finalist"]:checked'</span><span class="s7">).</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">box </span><span class="s7">=&gt;</span><span class="s1"> weeklyLogs</span><span class="s7">[</span><span class="s1">box</span><span class="s7">.</span><span class="s1">dataset</span><span class="s7">.</span><span class="s1">baker</span><span class="s7">].</span><span class="s1">push</span><span class="s7">({</span><span class="s1"> reason</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'Made it to the Final'</span><span class="s7">,</span><span class="s1"> points</span><span class="s7">:</span><span class="s1"> pointValues</span><span class="s7">[</span><span class="s8">'final'</span><span class="s7">]</span><span class="s1"> </span><span class="s7">}));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> winner </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'season-winner'</span><span class="s7">)?.</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">winner</span><span class="s7">)</span><span class="s1"> weeklyLogs</span><span class="s7">[</span><span class="s1">winner</span><span class="s7">].</span><span class="s1">push</span><span class="s7">({</span><span class="s1"> reason</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'Season Winner'</span><span class="s7">,</span><span class="s1"> points</span><span class="s7">:</span><span class="s1"> pointValues</span><span class="s7">[</span><span class="s8">'winner'</span><span class="s7">]</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>lastKnownBakers</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">bakerData </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> bakerRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> bakersCollectionPath</span><span class="s7">,</span><span class="s1"> bakerData</span><span class="s7">.</span><span class="s1">name</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> newEvents </span><span class="s7">=</span><span class="s1"> weeklyLogs</span><span class="s7">[</span><span class="s1">bakerData</span><span class="s7">.</span><span class="s1">name</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">let</span><span class="s1"> updatePayload </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{};</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">newEvents</span><span class="s7">.</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> pointsThisWeek </span><span class="s7">=</span><span class="s1"> newEvents</span><span class="s7">.</span><span class="s1">reduce</span><span class="s7">((</span><span class="s1">sum</span><span class="s7">,</span><span class="s1"> event</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> sum </span><span class="s7">+</span><span class="s1"> event</span><span class="s7">.</span><span class="s1">points</span><span class="s7">,</span><span class="s1"> </span><span class="s14">0</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>updatePayload</span><span class="s7">.</span><span class="s1">points </span><span class="s7">=</span><span class="s1"> </span><span class="s7">(</span><span class="s1">bakerData</span><span class="s7">.</span><span class="s1">points </span><span class="s7">||</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> pointsThisWeek</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> newLogEntry </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> week</span><span class="s7">:</span><span class="s1"> nextWeek</span><span class="s7">,</span><span class="s1"> events</span><span class="s7">:</span><span class="s1"> newEvents </span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>updatePayload</span><span class="s7">.</span><span class="s1">weeklyLog </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[...(</span><span class="s1">bakerData</span><span class="s7">.</span><span class="s1">weeklyLog </span><span class="s7">||</span><span class="s1"> </span><span class="s7">[]),</span><span class="s1"> newLogEntry</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">document</span><span class="s7">.</span><span class="s1">querySelector</span><span class="s7">(</span><span class="s8">`input[name="semi-finalist"][data-baker="</span><span class="s7">${</span><span class="s1">bakerData</span><span class="s7">.</span><span class="s1">name</span><span class="s7">}</span><span class="s8">"]:checked`</span><span class="s7">))</span><span class="s1"> updatePayload</span><span class="s7">.</span><span class="s1">hasSemiFinalBonus </span><span class="s7">=</span><span class="s1"> </span><span class="s12">true</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">document</span><span class="s7">.</span><span class="s1">querySelector</span><span class="s7">(</span><span class="s8">`input[name="finalist"][data-baker="</span><span class="s7">${</span><span class="s1">bakerData</span><span class="s7">.</span><span class="s1">name</span><span class="s7">}</span><span class="s8">"]:checked`</span><span class="s7">))</span><span class="s1"> updatePayload</span><span class="s7">.</span><span class="s1">hasFinalistBonus </span><span class="s7">=</span><span class="s1"> </span><span class="s12">true</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">winner </span><span class="s7">===</span><span class="s1"> bakerData</span><span class="s7">.</span><span class="s1">name</span><span class="s7">)</span><span class="s1"> updatePayload</span><span class="s7">.</span><span class="s1">isWinner </span><span class="s7">=</span><span class="s1"> </span><span class="s12">true</span><span class="s7">;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s13">Object</span><span class="s7">.</span><span class="s1">keys</span><span class="s7">(</span><span class="s1">updatePayload</span><span class="s7">).</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>batch</span><span class="s7">.</span><span class="s1">update</span><span class="s7">(</span><span class="s1">bakerRef</span><span class="s7">,</span><span class="s1"> updatePayload</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> leagueUpdate </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> week</span><span class="s7">:</span><span class="s1"> nextWeek </span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> eliminatedBaker </span><span class="s7">=</span><span class="s1"> getEl</span><span class="s7">(</span><span class="s8">'eliminated-baker'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s7">(</span><span class="s1">eliminatedBaker</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>batch</span><span class="s7">.</span><span class="s1">update</span><span class="s7">(</span><span class="s1">doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> bakersCollectionPath</span><span class="s7">,</span><span class="s1"> eliminatedBaker</span><span class="s7">),</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> status</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'eliminated'</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s7">(</span><span class="s1">currentLeagueState</span><span class="s7">.</span><span class="s1">availableBakers</span><span class="s7">.</span><span class="s1">includes</span><span class="s7">(</span><span class="s1">eliminatedBaker</span><span class="s7">))</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>leagueUpdate</span><span class="s7">.</span><span class="s1">availableBakers </span><span class="s7">=</span><span class="s1"> currentLeagueState</span><span class="s7">.</span><span class="s1">availableBakers</span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">b </span><span class="s7">=&gt;</span><span class="s1"> b </span><span class="s7">!==</span><span class="s1"> eliminatedBaker</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>batch</span><span class="s7">.</span><span class="s1">update</span><span class="s7">(</span><span class="s1">leagueRef</span><span class="s7">,</span><span class="s1"> leagueUpdate</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">await</span><span class="s1"> batch</span><span class="s7">.</span><span class="s1">commit</span><span class="s7">();</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>weeklyLogModal</span><span class="s7">.</span><span class="s1">style</span><span class="s7">.</span><span class="s1">display </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'none'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Start the app</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>init</span><span class="s7">();</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p8"><span class="s11"></span><br></p>
</body>
</html>
